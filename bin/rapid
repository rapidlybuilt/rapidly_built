#!/usr/bin/env ruby

require "bundler/setup"

class RapidCLI
  def self.run(args)
    new(args).run
  end

  def initialize(args)
    @args = args
  end

  def run
    if @args.empty?
      show_usage
      exit 1
    end

    command = @args.shift

    case command
    when "icons"
      run_icons_command
    when "help", "-h", "--help"
      show_usage
    else
      puts "‚ùå Unknown command: #{command}"
      show_usage
      exit 1
    end
  end

  private

  def run_icons_command
    require "rapid_ui/commands/icons"
    icons = RapidUI::Commands::Icons.new(base_dir: Dir.pwd)
    icons.run(@args)
  end

  def show_usage
    puts <<~USAGE
      rapid - CLI tools for RapidlyBuilt

      Usage:
        rapid <command> [options]

      Commands:
        icons import ICON_NAME     Import a Lucide icon to your project
        icons upgrade VERSION      Upgrade all imported icons to a new version
        help                       Show this help message

      Examples:
        rapid icons import arrow-down-up
        rapid icons import chevron-down
        rapid icons upgrade 0.550.0
    USAGE
  end
end

RapidCLI.run(ARGV)
